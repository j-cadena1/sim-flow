# Development Dockerfile for Backend
# Enables hot reload with tsx watch
ARG NODE_VERSION=20
FROM node:${NODE_VERSION}-alpine

WORKDIR /app

# Install dependencies for native modules and ffmpeg for video processing
RUN apk add --no-cache python3 make g++ ffmpeg curl

# Copy package files
COPY package*.json ./

# Install ALL dependencies (including dev dependencies)
RUN npm ci

# Copy source code (will be overridden by volume mount)
COPY . .

# Expose application port and debugger port
EXPOSE 3001 9229

# Development server with hot reload and debugging enabled
CMD ["npm", "run", "dev", "--", "--inspect=0.0.0.0:9229"]
